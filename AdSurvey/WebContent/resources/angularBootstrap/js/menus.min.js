insite.menus=function(){return{init:function(){window.self===window.top&&(jQuery(document).on("click","#menu-side ul > li > span",function(e){e.preventDefault(),insite.menus.toggle_side_kid(this)}),insite.menus.build(),insite.menus.prep_app_kid(),jQuery(document).on("click","#menu-app .menu-toggle",function(e){e.preventDefault(),insite.menus.toggle_app_kid(this)}),insite.menus.toggle_back_top(),insite.menus.get_user_stock(),jQuery(document).on("click","a.dropdown-toggle",function(){insite.menus.onscreen_main_drops(this)}),jQuery(document).on("click",'a[href="#top"]',function(e){e.preventDefault(),insite.menus.go_back_top()}),jQuery(document).on("click","a.btn-menu-app",function(){jQuery("#menu-app").removeClass("closed").addClass("opened")}),jQuery(document).on("click",'#menu-app a[href="#top"]',function(){jQuery("#menu-app").addClass("closed").removeClass("opened")}),jQuery("html.ie8").length&&insite.menus.ie_hacks())},build:function(){var e=jQuery("#up_doc_unid").attr("data-value");"guest"!=e&&"Anonymous"!=e&&""!=e&&"undefined"!=typeof e&&(url="https://"+insite.hostname+"/extras/menus/user/",url+=encodeURIComponent(encodeURIComponent(e)),jQuery.getJSON(url,function(e){jQuery("#menu-main").html(e.menu.main),jQuery("#menu-side").html(e.menu.side),jQuery("#menu-foot").html(e.menu.foot)}).done(function(){insite.menus.prep_main_cols(),jQuery("a#feedback-nsf").attr("href","/feedback.nsf/F_MAIN_FORM?OpenForm&db="+encodeURIComponent(window.location.pathname))}))},prep_main_cols:function(){jQuery("#menu-main .dropdown-menu .row:first-child").each(function(){jQuery(this).children("div").each(function(){jQuery.trim(jQuery(this).html())||jQuery(this).remove()}),cols=jQuery(this).children("div").length,jQuery(this).css("width",240*cols+"px"),jQuery(this).find("div").each(function(){jQuery(this).addClass("col-md-"+Math.floor(12/cols))})})},onscreen_main_drops:function(e){var n=jQuery(e).parent("li.dropdown").find("ul.dropdown-menu"),i=jQuery(n).offset();if(i.left+n.width()>jQuery(window).width()){var t=jQuery(window).width()-(i.left+n.width()+20);n.css({left:t})}},prep_app_kid:function(){jQuery("#menu-app li li.active").parents("ul").css("display","block"),jQuery("#menu-app li li.active").parents("li").addClass("open").find("i").removeClass("fa-caret-right").addClass("fa-caret-down")},toggle_app_kid:function(e){jQuery(e).parent("li").hasClass("open")?(jQuery(e).parent("li").removeClass("open"),jQuery(e).parent("li").find('ul[role="menu"]').slideUp(),jQuery(e).find("i").removeClass("fa-caret-down").addClass("fa-caret-right")):(jQuery("#menu-app .menu-toggle i").removeClass("fa-caret-down").addClass("fa-caret-right"),jQuery(e).parent("li").siblings().find('ul[role="menu"]').slideUp(),jQuery(e).parent("li").siblings().removeClass("open"),jQuery(e).find("i").addClass("fa-caret-down").removeClass("fa-caret-right"),jQuery(e).parent("li").find('ul[role="menu"]').slideDown(),jQuery(e).parent("li").addClass("open"))},toggle_side_kid:function(e){jQuery(e).parent("li").find(">ul").is(":visible")?(jQuery(e).find("i").removeClass("fa-caret-down").addClass("fa-caret-right"),jQuery(e).parent("li").find(">ul").slideUp()):(jQuery(e).parent("li").siblings().find("ul:visible").slideUp(function(){jQuery(this).parent("li").find("i.fa-caret-down").removeClass("fa-caret-down").addClass("fa-caret-right")}),jQuery(e).find("i").removeClass("fa-caret-right").addClass("fa-caret-down"),jQuery(e).parent("li").find(">ul").slideDown())},get_user_stock:function(){var e="https://"+insite.hostname+"/extras/widgets/stock/SPTN";jQuery.getJSON(e,function(e){jQuery("#menu-user .sptn-stock .ask").html(e.stock.last_trade.price),jQuery("#menu-user .sptn-stock .change").removeClass("up down").html(e.stock.change.price),null!==e.stock.change.percent&&jQuery("#menu-user .sptn-stock .change").addClass("+"==e.stock.change.percent.charAt(0)?"up":"down")})},toggle_back_top:function(){jQuery(window).scroll(function(){clearTimeout(jQuery.data(this,"scrollTimer")),jQuery.data(this,"scrollTimer",setTimeout(function(){jQuery("#back-top").fadeOut()},2500)),jQuery(this).scrollTop()>100?jQuery("#back-top").fadeIn():jQuery("#back-top").fadeOut()})},go_back_top:function(){jQuery("body,html").animate({scrollTop:0},400)},ie_hacks:function(){jQuery("#menu-user .menu-items ul li:last-child").css("border-right","0"),jQuery("#menu-user .cart-popover .row div:last-child").css("border-right","0"),jQuery("#menu-main .navbar-nav >li.dropdown:last-child .dropdown-menu").css("right","0"),jQuery("#menu-main .navbar-nav >li.dropdown:last-child >a").css("padding-left","0").css("padding-right","0")}}}();