insite.login=function(){return{unid:null,username:null,init:function(){insite.login.show_modal(),insite.login.check_browser(),insite.login.logouts(),insite.login.check_cookie("LoginMsg"),jQuery(document).on("keypress",function(e){13==e.which&&jQuery(".btn-submit:visible").trigger("click")}),jQuery(document).on("click",".signin .btn-submit",function(e){e.preventDefault(),insite.login.submit_signin()}),jQuery(document).on("click",".signin .btn-forgot",function(e){e.preventDefault(),insite.login.show_user_forgot(),insite.login.hide_success()}),jQuery(document).on("click",".forgot .btn-cancel",function(e){e.preventDefault(),insite.login.hide_forgot(),insite.login.hide_success()}),jQuery(document).on("click",".forgot.user .btn-submit",function(e){e.preventDefault(),insite.login.submit_user_forgot()}),jQuery(document).on("click",".forgot.associate .btn-submit",function(e){e.preventDefault(),insite.login.submit_associate_forgot()}),jQuery(document).on("click",".forgot.reset .btn-submit",function(e){e.preventDefault(),insite.login.submit_reset_forgot()}),jQuery(document).on("click",".signups .btn-associate",function(e){e.preventDefault(),insite.login.show_associate_signup()}),jQuery(document).on("click",".signup .btn-cancel",function(e){e.preventDefault(),insite.login.hide_success(),insite.login.hide_associate_signup()}),jQuery(document).on("click",".signup.associate .btn-submit",function(e){e.preventDefault(),insite.login.submit_associate_signup()}),jQuery(document).on("click",".signup.set .btn-submit",function(e){e.preventDefault(),insite.login.submit_set_signup()}),jQuery(document).on("click",'a[href="/sctyform.nsf/F_MAIN_FORM?OpenForm"]',function(e){e.preventDefault(),insite.login.goto_guest(this)}),jQuery(document).on("click",'a[href="/security.nsf/F_TERMS_OF_USE_VERBIAGE?OpenForm"]',function(e){e.preventDefault(),insite.login.goto_guest(this)})},submit_signin:function(){return insite.login.hide_error(),insite.login.hide_success(),insite.login.hide_warning(),0===jQuery("#signin_username").val().length?void insite.login.show_error("signin_username","Please enter your Insite username."):(jQuery("#signin_username").val(jQuery.trim(jQuery("#signin_username").val())),0===jQuery("#signin_password").val().length?void insite.login.show_error("signin_password","Please enter your Insite password."):(jQuery("#signin_password").val(jQuery.trim(jQuery("#signin_password").val())),void jQuery("#_CustomLoginForm").submit()))},show_user_forgot:function(){jQuery(".row.signin").fadeOut("fast",function(){insite.login.hide_error(),jQuery(".row.forgot.user").fadeIn("fast",function(){insite["interface"].is_touch()||jQuery("html.ie8").length||jQuery("#forgot_username").focus()})})},submit_user_forgot:function(){insite.login.hide_error(),insite.login.hide_warning();var e=jQuery("#forgot_username").val();if(0===e.length)return void insite.login.show_error("forgot_username","Please enter your Insite username.");jQuery(".forgot.user .btn-submit .fa-spinner").show();jQuery.ajax({type:"GET",url:"https://"+insite.hostname+"/security.nsf/A_WS_GET_USER_PWCHDT_JSON?OpenAgent",dataType:"json",data:{userid:e}}).fail(function(){insite.login.show_error("forgot_username","Something went wrong. Please contact Computer Support at 616-878-2480 for assistance."),jQuery(".forgot.user .btn-submit .fa-spinner").hide()}).done(function(i){"true"==i.user[0].up_password_change_allowed?insite.login.process_user_forgot(e):(insite.login.show_error("forgot_username","Please wait at least 15 minutes between password changes. Please contact Computer Support at 616-878-2480 if you require additional assistance."),jQuery(".forgot.user .btn-submit .fa-spinner").hide())})},process_user_forgot:function(e){jQuery.ajax({type:"POST",url:"https://"+insite.hostname+"/security.nsf/A_USER_FORGOTPW?OpenAgent",dataType:"json",data:{Id:e}}).fail(function(){insite.login.show_error("forgot_username","Something went wrong. Please contact Computer Support at 616-878-2480 for assistance.")}).done(function(e){"Success"==e.response[0].status?"resetSptnPassword"==e.response[0].return_code?insite.login.show_associate_forgot():"resetExtPassword"==e.response[0].return_code&&(insite.login.hide_forgot(),insite.login.show_success("Your new password has been emailed to you. Please contact Computer Support at 616-878-2480 if you require additional assistance."),insite.analytics.event("Login","Forgot Password","Partner Password Reset")):insite.login.show_error("forgot_username",e.response[0].message)}).always(function(){jQuery(".forgot.user .btn-submit .fa-spinner").hide()})},hide_forgot:function(){jQuery(".row.forgot:visible").fadeOut("fast",function(){insite.login.hide_error(),insite.login.hide_warning(),insite.login.clear_form(),jQuery(".row.signin").fadeIn("fast",function(){insite["interface"].is_touch()||jQuery("html.ie8").length||jQuery("#signin_username").focus()})})},show_associate_forgot:function(){jQuery(".row.forgot:visible").fadeOut("fast",function(){insite.login.hide_error(),insite.login.hide_warning(),jQuery(".row.forgot.associate").fadeIn("fast",function(){insite["interface"].is_touch()||jQuery("html.ie8").length||jQuery("#forgot_peoplesoftid").focus()})})},submit_associate_forgot:function(){if(insite.login.hide_error(),insite.login.hide_warning(),jQuery("#forgot_peoplesoftid").val().length<6)return void insite.login.show_error("forgot_peoplesoftid","Please enter your six digit PeopleSoft ID.");if(jQuery("#forgot_zipcode").val().length<4)return void insite.login.show_error("forgot_zipcode","Please enter your five digit home zip code.");if(jQuery("#forgot_birthyear").val().length<4)return void insite.login.show_error("forgot_birthyear","Please enter your four digit birth year.");if(jQuery("#forgot_lastfourssn").val().length<4)return void insite.login.show_error("forgot_lastfourssn","Please enter the last four digits of your Social Security number.");jQuery(".forgot.associate .btn-submit .fa-spinner").show();jQuery.ajax({type:"POST",url:"https://"+insite.hostname+"/security.nsf/A_USER_ACTIVATESPRTN?OpenAgent",dataType:"json",data:{PeopleSoftId:jQuery("#forgot_peoplesoftid").val(),ZipCode:jQuery("#forgot_zipcode").val(),BirthYear:jQuery("#forgot_birthyear").val(),LastFourSsn:jQuery("#forgot_lastfourssn").val(),Task:"pwd"}}).fail(function(){insite.login.show_error("","Something went wrong. Please contact Computer Support at 616-878-2480 for assistance.")}).done(function(e){"Success"==e.response[0].status?(insite.login.unid=e.response[0].unid,insite.login.show_reset_forgot(),insite.login.show_success("Your identity has been verified.")):insite.login.show_error("","Something went wrong. "+e.response[0].message)}).always(function(){jQuery(".forgot.associate .btn-submit .fa-spinner").hide()})},show_reset_forgot:function(){jQuery(".row.forgot:visible").fadeOut("fast",function(){insite.login.hide_error(),insite.login.hide_warning(),jQuery(".row.forgot.reset").fadeIn("fast",function(){insite["interface"].is_touch()||jQuery("html.ie8").length||jQuery("#forgot_reset").focus()})})},submit_reset_forgot:function(){if(insite.login.hide_error(),insite.login.hide_success(),insite.login.hide_warning(),jQuery("#forgot_reset").val().length<6)return void insite.login.show_error("forgot_reset","Your password must be at least six characters.");if(!isNaN(jQuery("#forgot_reset").val().charAt(0)))return void insite.login.show_error("forgot_reset","Your password may not begin with a number.");if(jQuery("#forgot_reset").val()!=jQuery("#forgot_reset_confirmation").val())return void insite.login.show_error("forgot_reset","Your password and confirmation do not match.");jQuery(".forgot.reset .btn-submit .fa-spinner").show();jQuery.ajax({type:"POST",url:"https://"+insite.hostname+"/security.nsf/A_USER_CHANGEPW?OpenAgent",dataType:"json",data:{Unid:insite.login.unid,Pwd:jQuery("#forgot_reset").val()}}).fail(function(){insite.login.show_error("","Something went wrong. Please contact Computer Support at 616-878-2480 for assistance.")}).done(function(e){if("Success"==e.response[0].status){insite.login.hide_forgot(),insite.login.show_success("Your password has been reset. Please login below."),insite.analytics.event("Login","Forgot Password","Associate Password Reset");var i=new Date;i.setTime(i.getTime()+6e5),jQuery.cookie("LoginRst","Please wait at least 15 minutes between password resets.",{epires:i,path:"/",domain:"."+insite.domain})}else insite.login.show_error("","Something went wrong. "+e.response[0].message)}).always(function(){jQuery(".forgot.reset .btn-submit .fa-spinner").hide()})},show_associate_signup:function(){jQuery(".row.signin:visible, .row.forgot:visible").fadeOut("fast",function(){insite.login.hide_error(),insite.login.hide_warning(),jQuery(".row.signup.associate").fadeIn("fast",function(){insite["interface"].is_touch()||jQuery("html.ie8").length||jQuery("#signup_peoplesoftid").focus()})})},hide_associate_signup:function(){jQuery(".row.signup:visible").fadeOut("fast",function(){insite.login.hide_error(),insite.login.hide_warning(),insite.login.clear_form(),jQuery(".row.signin").fadeIn("fast",function(){insite["interface"].is_touch()||jQuery("html.ie8").length||jQuery("#signin_username").focus()})})},submit_associate_signup:function(){if(insite.login.hide_error(),insite.login.hide_warning(),jQuery("#signup_peoplesoftid").val().length<6)return void insite.login.show_error("signup_peoplesoftid","Please enter your six digit PeopleSoft ID.");if(jQuery("#signup_zipcode").val().length<4)return void insite.login.show_error("signup_zipcode","Please enter your five digit home zip code.");if(jQuery("#signup_birthyear").val().length<4)return void insite.login.show_error("signup_birthyear","Please enter your four digit birth year.");if(jQuery("#signup_lastfourssn").val().length<4)return void insite.login.show_error("signup_lastfourssn","Please enter the last four digits of your Social Security number.");if(!jQuery("#signup_terms").prop("checked"))return void insite.login.show_error("signup_terms","You must accept the Insite Terms of Use.");jQuery(".signup.associate .btn-submit .fa-spinner").show();jQuery.ajax({type:"POST",url:"https://"+insite.hostname+"/security.nsf/A_USER_ACTIVATESPRTN?OpenAgent",dataType:"json",data:{PeopleSoftId:jQuery("#signup_peoplesoftid").val(),ZipCode:jQuery("#signup_zipcode").val(),BirthYear:jQuery("#signup_birthyear").val(),LastFourSsn:jQuery("#signup_lastfourssn").val(),Task:"verify"}}).fail(function(e){insite.login.show_error("",e.response[0].message)}).done(function(e){"Success"==e.response[0].status?(insite.login.unid=e.response[0].unid,insite.login.username=e.response[0].userid,insite.login.show_set_signup(),insite.login.show_success("Your account is almost ready. You just need to set a password below."),insite.analytics.event("Login","Sign Up","Associate Profile Created")):insite.login.show_error("",e.response[0].message)}).always(function(){jQuery(".signup.associate .btn-submit .fa-spinner").hide()})},show_set_signup:function(){jQuery(".row.signup:visible").fadeOut("fast",function(){insite.login.hide_error(),insite.login.hide_warning(),jQuery(".row.signup.set").fadeIn("fast",function(){insite["interface"].is_touch()||jQuery("html.ie8").length||jQuery("#signup_set").focus()})})},submit_set_signup:function(){if(insite.login.hide_error(),insite.login.hide_success(),insite.login.hide_warning(),jQuery("#signup_set").val().length<6)return void insite.login.show_error("signup_set","Your password must be at least six characters.");if(!isNaN(jQuery("#signup_set").val().charAt(0)))return void insite.login.show_error("signup_set","Your password may not begin with a number.");if(jQuery("#signup_set").val()!=jQuery("#signup_set_confirmation").val())return void insite.login.show_error("signup_set","Your password and confirmation do not match.");if(!jQuery("#signup_terms").prop("checked"))return void insite.login.show_error("signup_terms","You must accept Insite's Terms of Use.");jQuery(".signup.set .btn-submit .fa-spinner").show();jQuery.ajax({type:"POST",url:"https://"+insite.hostname+"/security.nsf/A_USER_CHANGEPW?OpenAgent",dataType:"json",data:{Unid:insite.login.unid,Pwd:jQuery("#signup_set").val()}}).fail(function(){insite.login.show_error("","Something went wrong. Please contact Computer Support at 616-878-2480 for assistance.")}).done(function(e){"Success"==e.response[0].status?(insite.login.hide_associate_signup(),insite.login.show_success("Thank you for signing up. Your new Insite username is <b>"+insite.login.username+"</b>. Please allow five minutes while we complete your setup. At which point, you may login below."),insite.analytics.event("Login","Sign Up","Associate Password Set")):insite.login.show_error("","Something went wrong. "+e.response[0].message)}).always(function(){jQuery(".signup.set .btn-submit .fa-spinner").show()})},goto_guest:function(e){var i="https://"+insite.hostname+"/names.nsf?Login=$$LoginUserForm";i+="&Username=guest&Password=guest100",i+="&RedirectTo="+jQuery(e).attr("href"),"_blank"==jQuery(e).attr("target")?window.open(i):window.location=i},show_modal:function(){jQuery(".login .modal").modal({keyboard:!1}).css("background-image","url("+insite.cdn+"/img/login-bg-"+(Math.round(1*Math.random())+1)+".jpg)"),jQuery(".login .modal").on("hide.bs.modal",function(e){e.preventDefault()}),insite["interface"].is_touch()||jQuery("html.ie8").length||setTimeout(function(){jQuery("#signin_username").focus()},500)},check_browser:function(){if(jQuery("html.ie6").length||jQuery("html.ie7").length){var e="Your web browser is no longer supported.";e+=' Please update <a href="http://microsoft.com/ie">Internet Explorer</a>.',e+=' Alternatively, you may install and use either Google\'s <a href="http://google.com/chrome">Chrome</a>',e+=' or Mozilla\'s <a href="http://mozilla.org/firefox">Firefox</a> browser. Both are available without cost.',jQuery(".error").show().find(".alert").html("<b>Uh oh!</b> "+e),jQuery("input, button").prop("disabled",!0)}else if(jQuery("html.ie8").length){var e='You are using Internet Explorer 8. Beginning January 12, 2016, your web browser will <a href="http://support.microsoft.com/en-us/gp/microsoft-internet-explorer" target="_blank">no longer be supported</a>.';e+=' Please update <a href="http://microsoft.com/ie">Internet Explorer</a>.',e+=' Alternatively, you may install and use either Google\'s <a href="http://google.com/chrome">Chrome</a>',e+=' or Mozilla\'s <a href="http://mozilla.org/firefox">Firefox</a> browser. Both are available without cost.',jQuery(".warning").show().find(".alert").html("<b>Warning!</b> "+e)}},check_cookie:function(e){var i=jQuery.cookie(e);void 0!==i&&"undefined"!==i&&null!==i&&(insite.login.show_warning(i),jQuery.removeCookie(e,{domain:"."+insite.hostname}))},show_warning:function(e){jQuery(".warning").show().find(".alert").html("<b>Warning!</b> "+e)},hide_warning:function(){jQuery(".warning").hide().find(".alert").html("")},show_success:function(e){jQuery(".success").show().find(".alert").html("<b>Success!</b> "+e)},hide_success:function(){jQuery(".success").hide().find(".alert").html("")},show_error:function(e,i){""!=e&&(jQuery("#"+e).parents(".form-group").addClass("has-error"),jQuery("#"+e).val(""),insite["interface"].is_touch()||jQuery("html.ie8").length||jQuery("#"+e).focus()),jQuery(".error").show().find(".alert").html("<b>Oops!</b> "+i)},hide_error:function(){jQuery(".error").hide().find(".alert").html(""),jQuery(".form-group").removeClass("has-error")},clear_form:function(){jQuery('.login input[type="text"], .login input[type="password"]').val("")},logouts:function(){jQuery("<iframe />",{width:"1",height:"1",src:"https://sp2.spartanstores.com/names.nsf?Logout",style:"display:none;"}).appendTo("body")}}}();